---
import Layout from '../layouts/Layout.astro';
import Section from '../components/Section.astro';
import Panel from '../components/Panel.astro';
import InstallCommand from '../components/InstallCommand.astro';
import Button from '../components/Button.astro';
import messaging from '../data/messaging.json';

const base = import.meta.env.BASE_URL.endsWith('/')
  ? import.meta.env.BASE_URL
  : `${import.meta.env.BASE_URL}/`;

const hero = messaging.hero || {};
const heroSubheadline = hero.subheadline || 'Motus knows.';
const heroValueProp = hero.value_prop || 'Every action logged. Every decision recorded. Every outcome a receipt.';
const heroCtaText = hero.cta_text || 'Get your first receipt';
const heroCtaPath = hero.cta_url ? hero.cta_url.replace(/^\/+/, '') : 'get-started';
const heroCtaHref = `${base}${heroCtaPath}`;
---

<Layout title="Motus - What did your agent actually do?">
  <!-- HERO -->
  <Section tone="dark" pad="hero" class="text-center" innerClass="max-w-5xl">
    <h1 class="text-3xl md:text-5xl lg:text-6xl font-display text-text-secondary mb-phi-2">
      What did your agent <span class="whitespace-nowrap">actually do?</span>
    </h1>
    <p class="text-4xl md:text-6xl lg:text-7xl font-display text-mint mb-phi-4">
      {heroSubheadline}
    </p>

    <p class="text-lg md:text-xl text-text-secondary mb-phi-3 max-w-2xl mx-auto">
      {heroValueProp}
    </p>

    <div class="flex flex-col sm:flex-row gap-phi-3 justify-center items-center mb-phi-4">
      <InstallCommand />
      <Button href={heroCtaHref} variant="secondary">
        {heroCtaText} &#8594;
      </Button>
    </div>

    <p class="text-sm text-text-secondary/60">
      Works with Claude, GPT, Gemini, LangChain, n8n, and local agents.
    </p>
  </Section>

  <!-- ============================================================
       SECTION 1: WORKFLOW COMPRESSION
       Light background, side-by-side code comparison
       ============================================================ -->
  <Section tone="light" pad="tight" innerClass="max-w-5xl">
    <p class="text-xs uppercase tracking-[0.2em] text-mint mb-phi-2 text-center">Workflow Compression</p>

    <h2 class="text-4xl md:text-5xl lg:text-6xl font-display text-text-primary mb-phi-2 text-center">
      95<span class="text-mint">%</span> fewer tokens
    </h2>

    <p class="text-lg text-text-secondary text-center mb-phi-5 max-w-2xl mx-auto">
      Context grows O(n) with each handoff. Receipts stay flat.
    </p>

    <!-- Side-by-side comparison -->
    <div class="grid md:grid-cols-2 gap-phi-4 mb-phi-4">
      <!-- WITHOUT MOTUS -->
      <div class="rounded-xl border border-line/50 overflow-hidden bg-surface">
        <div class="px-phi-3 py-phi-2 border-b border-line/30 bg-surface-muted/50">
          <p class="text-xs uppercase tracking-wider text-text-secondary/60">Without Motus</p>
        </div>
        <div class="p-phi-4 font-mono text-sm bg-charcoal text-text-secondary overflow-x-auto">
          <pre class="whitespace-pre-wrap"><code><span class="text-text-secondary/50"># Developer pastes context manually</span>

Here's the code from the previous session:

```python
class Task(Base):
    id = Column(UUID, primary_key=True)
    title = Column(String(255))
    status = Column(Enum(TaskStatus))
    # ... 40 more lines
```

Design decisions:
- Used UUID for distributed systems
- Soft delete via deleted_at
- Status transitions validated

The API endpoints are in src/api/...
<span class="text-error/70"># 887 tokens of context</span></code></pre>
        </div>
        <div class="px-phi-3 py-phi-2 border-t border-line/30 bg-surface-muted/30">
          <p class="text-sm text-text-secondary/60 font-mono">887 tokens</p>
        </div>
      </div>

      <!-- WITH MOTUS -->
      <div class="rounded-xl border border-mint/30 overflow-hidden bg-surface">
        <div class="px-phi-3 py-phi-2 border-b border-mint/20 bg-mint/5">
          <p class="text-xs uppercase tracking-wider text-mint">With Motus</p>
        </div>
        <div class="p-phi-4 font-mono text-sm bg-charcoal text-text-secondary overflow-x-auto">
          <pre class="whitespace-pre-wrap"><code><span class="text-mint">$</span> motus work context TASK-003

<span class="text-text-secondary/50">{</span>
  <span class="text-mint">"task"</span>: <span class="text-text-primary">"integration-tests"</span>,
  <span class="text-mint">"parent_receipts"</span>: [<span class="text-text-primary">"rx_001"</span>, <span class="text-text-primary">"rx_002"</span>],
  <span class="text-mint">"summary"</span>: {
    <span class="text-mint">"model"</span>: <span class="text-text-primary">"Task (UUID, status enum)"</span>,
    <span class="text-mint">"api"</span>: <span class="text-text-primary">"CRUD /tasks, auth required"</span>,
    <span class="text-mint">"decisions"</span>: [<span class="text-text-primary">"soft delete"</span>, <span class="text-text-primary">"max 100"</span>]
  }
<span class="text-text-secondary/50">}</span>

<span class="text-mint/70"># 43 tokens • 0.15ms</span></code></pre>
        </div>
        <div class="px-phi-3 py-phi-2 border-t border-mint/20 bg-mint/5">
          <p class="text-sm text-mint font-mono">43 tokens</p>
        </div>
      </div>
    </div>

    <!-- Proof link -->
    <div class="text-center">
      <a
        href="https://github.com/motus-os/motus/tree/main/packages/cli/benchmarks"
        target="_blank"
        rel="noopener"
        class="inline-flex items-center gap-phi-1 text-sm text-mint hover:underline"
      >
        Run the benchmark yourself
        <span aria-hidden="true">&#8594;</span>
      </a>
    </div>
  </Section>

  <!-- ============================================================
       SECTION 2: MULTI-AGENT ORCHESTRATION
       Dark background, receipt chain flow
       ============================================================ -->
  <Section tone="dark" pad="tight" innerClass="max-w-5xl">
    <p class="text-xs uppercase tracking-[0.2em] text-mint mb-phi-2 text-center">Multi-Agent</p>

    <h2 class="text-4xl md:text-5xl lg:text-6xl font-display text-text-primary mb-phi-2 text-center">
      Any agent<span class="text-mint">.</span> Any provider<span class="text-mint">.</span>
    </h2>

    <p class="text-lg text-text-secondary text-center mb-phi-5 max-w-2xl mx-auto">
      Receipts are the universal handoff format. Brand doesn't matter.
    </p>

    <!-- Receipt chain flow -->
    <div class="flex flex-col md:flex-row items-center justify-center gap-phi-3 md:gap-phi-2 mb-phi-5">
      <!-- Receipt 1 -->
      <div class="w-full md:w-auto">
        <Panel tone="dark" size="sm" class="text-center min-w-[160px]">
          <p class="font-mono text-mint text-lg mb-phi-1">rx_001</p>
          <p class="text-sm text-text-secondary mb-phi-2">Data model</p>
          <div class="inline-flex items-center gap-phi-1 px-phi-2 py-1 rounded-full bg-surface-muted/50 text-xs text-text-secondary/70">
            <span class="w-2 h-2 rounded-full bg-[#cc9b7a]"></span>
            Claude
          </div>
        </Panel>
      </div>

      <!-- Arrow -->
      <div class="text-mint text-2xl md:rotate-0 rotate-90" aria-hidden="true">&#8594;</div>

      <!-- Receipt 2 -->
      <div class="w-full md:w-auto">
        <Panel tone="dark" size="sm" class="text-center min-w-[160px]">
          <p class="font-mono text-mint text-lg mb-phi-1">rx_002</p>
          <p class="text-sm text-text-secondary mb-phi-2">API endpoints</p>
          <div class="inline-flex items-center gap-phi-1 px-phi-2 py-1 rounded-full bg-surface-muted/50 text-xs text-text-secondary/70">
            <span class="w-2 h-2 rounded-full bg-[#10a37f]"></span>
            GPT
          </div>
        </Panel>
      </div>

      <!-- Arrow -->
      <div class="text-mint text-2xl md:rotate-0 rotate-90" aria-hidden="true">&#8594;</div>

      <!-- Receipt 3 -->
      <div class="w-full md:w-auto">
        <Panel tone="dark" size="sm" class="text-center min-w-[160px]">
          <p class="font-mono text-mint text-lg mb-phi-1">rx_003</p>
          <p class="text-sm text-text-secondary mb-phi-2">Integration tests</p>
          <div class="inline-flex items-center gap-phi-1 px-phi-2 py-1 rounded-full bg-surface-muted/50 text-xs text-text-secondary/70">
            <span class="w-2 h-2 rounded-full bg-[#4285f4]"></span>
            Gemini
          </div>
        </Panel>
      </div>
    </div>

    <!-- The insight -->
    <div class="max-w-2xl mx-auto text-center">
      <p class="text-text-secondary mb-phi-3">
        <span class="text-text-primary">Claude</span> builds the model. Ships a receipt.<br/>
        <span class="text-text-primary">GPT</span> reads the receipt. Builds the API.<br/>
        <span class="text-text-primary">Gemini</span> sees both. Writes the tests.
      </p>
      <p class="text-sm text-text-secondary/60">
        No context window limits. No re-prompting. Just receipts.
      </p>
    </div>
  </Section>

  <!-- ============================================================
       SECTION 3: ECOSYSTEM MULTIPLIER
       Light background, receipt anatomy
       ============================================================ -->
  <Section tone="light" pad="tight" innerClass="max-w-5xl">
    <p class="text-xs uppercase tracking-[0.2em] text-mint mb-phi-2 text-center">Ecosystem</p>

    <h2 class="text-4xl md:text-5xl lg:text-6xl font-display text-text-primary mb-phi-2 text-center">
      1 + 1 = 3
    </h2>

    <p class="text-lg text-text-secondary text-center mb-phi-5 max-w-2xl mx-auto">
      Every agent makes the next one smarter. Work compounds, not evaporates.
    </p>

    <!-- Receipt anatomy -->
    <div class="max-w-2xl mx-auto mb-phi-5">
      <div class="rounded-xl border border-line/50 overflow-hidden bg-surface">
        <div class="px-phi-4 py-phi-3 border-b border-line/30 bg-surface-muted/30">
          <p class="font-mono text-mint">receipt rx_002</p>
        </div>
        <div class="divide-y divide-line/20">
          <!-- Outcome -->
          <div class="p-phi-4 flex gap-phi-4">
            <div class="w-24 shrink-0">
              <p class="text-sm font-display text-mint">Outcome</p>
            </div>
            <div class="flex-1">
              <p class="text-sm text-text-secondary">
                <span class="text-text-primary">src/api/tasks.py</span> — CRUD endpoints with auth, pagination, soft delete
              </p>
            </div>
          </div>
          <!-- Evidence -->
          <div class="p-phi-4 flex gap-phi-4">
            <div class="w-24 shrink-0">
              <p class="text-sm font-display text-mint">Evidence</p>
            </div>
            <div class="flex-1">
              <p class="text-sm text-text-secondary">
                <span class="text-text-primary">14 tests passing</span> — OpenAPI spec generated, auth middleware verified
              </p>
            </div>
          </div>
          <!-- Decisions -->
          <div class="p-phi-4 flex gap-phi-4">
            <div class="w-24 shrink-0">
              <p class="text-sm font-display text-mint">Decisions</p>
            </div>
            <div class="flex-1">
              <p class="text-sm text-text-secondary">
                <span class="text-text-primary">"403 on invalid transition"</span> — Pagination max 100, scope to authenticated user
              </p>
            </div>
          </div>
        </div>
        <div class="px-phi-4 py-phi-3 border-t border-line/30 bg-surface-muted/30 flex justify-between items-center">
          <p class="text-xs text-text-secondary/60 font-mono">parent: rx_001</p>
          <p class="text-xs text-text-secondary/60 font-mono">sha256:a7f3...</p>
        </div>
      </div>
    </div>

    <!-- The insight -->
    <div class="max-w-2xl mx-auto text-center">
      <p class="text-text-secondary mb-phi-3">
        Outcomes become the next agent's starting point.<br/>
        Evidence proves what actually happened.<br/>
        Decisions become institutional knowledge.
      </p>
      <a
        href={`${base}how-it-works`}
        class="inline-flex items-center gap-phi-1 text-sm text-mint hover:underline"
      >
        See how it works
        <span aria-hidden="true">&#8594;</span>
      </a>
    </div>
  </Section>

  <!-- FINAL CTA -->
  <Section tone="dark" pad="tight" class="text-center" innerClass="max-w-2xl">
    <h2 class="text-2xl md:text-3xl font-display text-text-primary mb-phi-2">
      Know what your agents did.
    </h2>
    <p class="text-text-secondary mb-phi-4">
      Get your first receipt in 5 minutes.
    </p>
    <InstallCommand />
  </Section>
</Layout>
