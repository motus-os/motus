---
import Layout from '../layouts/Layout.astro';
import Section from '../components/Section.astro';
import Panel from '../components/Panel.astro';
import InstallCommand from '../components/InstallCommand.astro';
import SectionHeader from '../components/SectionHeader.astro';
import DemoLoop from '../components/DemoLoop.astro';
import Button from '../components/Button.astro';
import messaging from '../data/messaging.json';

const base = import.meta.env.BASE_URL.endsWith('/')
  ? import.meta.env.BASE_URL
  : `${import.meta.env.BASE_URL}/`;

const hero = messaging.hero || {};
const heroHeadline = hero.headline || 'Agents do the work.';
const heroSubheadline = hero.subheadline || 'Motus keeps the receipts.';
const heroValueProp = hero.value_prop || 'One API. Verification infrastructure for AI that acts.';
const heroActionLine = hero.action_line || 'Claim work. Attach proof. Ship a receipt.';
const heroCtaText = hero.cta_text || 'Run a verified loop';
const heroCtaPath = hero.cta_url ? hero.cta_url.replace(/^\/+/, '') : 'get-started';
const heroCtaHref = `${base}${heroCtaPath}`;
---

<Layout title="Motus - Verification infrastructure for AI agents">
  <Section tone="dark" pad="hero" class="text-center" innerClass="max-w-4xl">
    <div class="mb-phi-5 space-y-phi-3">
      <h1 class="text-4xl md:text-6xl font-display text-text-primary">
        {heroHeadline}
      </h1>
      <p class="text-3xl md:text-5xl font-display text-mint">
        {heroSubheadline}
      </p>
    </div>

    <div class="w-32 h-px bg-mint/70 mx-auto mb-phi-5"></div>

    <p class="text-lg md:text-xl text-text-secondary mb-phi-2">
      {heroValueProp}
    </p>
    <p class="text-base md:text-lg text-text-secondary/80 mb-phi-5">
      {heroActionLine}
    </p>

    <div class="flex flex-col md:flex-row gap-phi-3 justify-center items-center">
      <InstallCommand />
      <Button href={heroCtaHref} variant="secondary">
        {heroCtaText} &#8594;
      </Button>
    </div>
  </Section>

  <Section tone="light" pad="tight" class="border-t border-line/30">
    <p class="text-sm text-text-secondary max-w-2xl mx-auto mb-phi-2 text-center">
      What happened, why it worked, proof it’s done.
    </p>
    <SectionHeader
      eyebrow="Demo"
      title="See it work"
      subtitle="Claim. Prove. Release. Get a receipt in minutes. No cloud required."
      size="md"
      align="left"
      maxWidth="max-w-3xl"
      class="mb-phi-4"
    />
    <div class="grid lg:grid-cols-[1.1fr_1fr] gap-phi-3">
      <DemoLoop />
      <div class="grid md:grid-cols-3 lg:grid-cols-1 gap-phi-3">
        <Panel size="sm" class="space-y-phi-2">
          <p class="text-xs uppercase tracking-[0.25em] text-text-secondary">Claim</p>
          <p class="text-sm text-text-secondary">Take ownership of the task.</p>
          <code class="text-mint font-mono text-sm block">motus work claim &lt;roadmap_id&gt; --intent &quot;Describe the task&quot;</code>
          <p class="text-xs text-text-secondary">You now own this work.</p>
        </Panel>
        <Panel size="sm" class="space-y-phi-2">
          <p class="text-xs uppercase tracking-[0.25em] text-text-secondary">Prove</p>
          <p class="text-sm text-text-secondary">Attach evidence and a decision.</p>
          <code class="text-mint font-mono text-sm block">motus work evidence &lt;lease_id&gt; test_result --passed 12 --failed 0</code>
          <code class="text-mint font-mono text-sm block">motus work decision &lt;lease_id&gt; &quot;Decision summary&quot;</code>
          <p class="text-xs text-text-secondary">Evidence attached.</p>
        </Panel>
        <Panel size="sm" class="space-y-phi-2">
          <p class="text-xs uppercase tracking-[0.25em] text-text-secondary">Release</p>
          <p class="text-sm text-text-secondary">Ship the receipt.</p>
          <code class="text-mint font-mono text-sm block">motus work release &lt;lease_id&gt; success</code>
          <code class="text-mint font-mono text-sm block">motus work status &lt;lease_id&gt;</code>
          <p class="text-xs text-text-secondary">Receipt shipped.</p>
        </Panel>
      </div>
    </div>
    <p class="mt-phi-2 text-sm text-text-secondary">
      That’s the loop. Every action verified.
    </p>
    {messaging.demo?.status === 'real' && (
      <div class="mt-phi-3">
        <img
          src={`${base}demo.gif`}
          alt={messaging.demo.alt || 'Motus demo'}
          class="rounded-xl border border-line/30 mx-auto max-w-2xl"
          loading="lazy"
        />
        {messaging.demo.caption && (
          <p class="text-sm text-text-secondary text-center mt-phi-2">
            {messaging.demo.caption}
          </p>
        )}
      </div>
    )}
    <div class="mt-phi-3 flex flex-wrap items-center gap-phi-2 text-sm text-text-secondary">
      <span>Need the full walkthrough?</span>
      <a href={`${base}get-started`} class="text-mint hover:text-text-primary transition-colors">
        Get Started &#8594;
      </a>
    </div>
  </Section>

  <Section tone="light" class="text-center border-t border-line/30" innerClass="max-w-4xl">
    <h2 class="text-3xl md:text-4xl font-display text-text-primary mb-phi-3">Source Available. Verifiable. Yours.</h2>
    <p class="text-lg text-text-secondary mb-phi-4 leading-relaxed">
      Audit the execution model and keep receipts local.<br class="hidden md:inline" />
      Source-available Work Compiler + local-first storage.
    </p>

    <div class="flex flex-col md:flex-row gap-phi-3 justify-center items-center text-left md:text-center">
        <div class="flex flex-col items-start md:items-center gap-phi-1">
          <div class="flex items-center gap-phi-1">
            <span class="text-mint text-xl">&#10003;</span>
            <span class="text-text-primary">Your receipts are your data</span>
          </div>
        </div>
        <div class="flex flex-col items-start md:items-center gap-phi-1">
          <div class="flex items-center gap-phi-1">
            <span class="text-mint text-xl">&#10003;</span>
            <span class="text-text-primary">Local by default</span>
          </div>
        </div>
        <div class="flex flex-col items-start md:items-center gap-phi-1">
          <div class="flex items-center gap-phi-1">
            <span class="text-mint text-xl">&#10003;</span>
            <span class="text-text-primary">Audit the full workflow</span>
          </div>
        </div>
    </div>

    <div class="mt-phi-4">
      <Button href="https://pypi.org/project/motusos/" target="_blank" rel="noopener" variant="secondary" size="sm">
        View on PyPI
      </Button>
    </div>
  </Section>

  <Section tone="light" class="text-center" innerClass="max-w-2xl">
    <h2 class="text-2xl md:text-3xl font-display text-text-primary mb-phi-3">
      Ready to make your agents capable?
    </h2>
    <InstallCommand />
  </Section>
</Layout>
