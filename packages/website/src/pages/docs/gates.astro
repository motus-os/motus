---
import Layout from '../../layouts/Layout.astro';
import Section from '../../components/Section.astro';
import SectionHeader from '../../components/SectionHeader.astro';
import Panel from '../../components/Panel.astro';

const base = import.meta.env.BASE_URL.endsWith('/')
  ? import.meta.env.BASE_URL
  : `${import.meta.env.BASE_URL}/`;
---

<Layout title="Gates - Motus">
  <Section tone="dark" pad="hero" class="text-center" innerClass="max-w-3xl">
    <SectionHeader
      eyebrow="Evidence & Gates"
      subtitle="Gate criteria define what a complete receipt looks like."
      size="xl"
    >
      <span slot="title">Gates make execution safe.</span>
    </SectionHeader>
    <div class="mt-phi-3 flex flex-wrap justify-center gap-phi-2 text-sm">
      <a href={`${base}docs/evidence`} class="text-mint hover:text-text-primary transition-colors">Evidence registry</a>
      <a href={`${base}how-it-works#gates`} class="text-mint hover:text-text-primary transition-colors">How the loop enforces gates</a>
      <a href={`${base}implementation#phase-gates`} class="text-mint hover:text-text-primary transition-colors">Phase gates</a>
    </div>
  </Section>

  <Section tone="light" pad="tight" innerClass="max-w-5xl">
    <SectionHeader
      eyebrow="Gate Types"
      title="Three checks, one outcome"
      subtitle="Each gate maps to the six-call loop."
      align="left"
      size="md"
      class="mb-phi-4"
      maxWidth="max-w-3xl"
    />
    <div class="grid md:grid-cols-3 gap-phi-3">
      <Panel size="sm" class="space-y-phi-2">
        <h3 class="text-lg font-display text-text-primary">Policy gate</h3>
        <p class="text-sm text-text-secondary">Only eligible work can proceed.</p>
        <p class="text-sm text-text-secondary">Validates eligibility, scope, and policy packs.</p>
        <p class="text-xs uppercase tracking-[0.25em] text-text-secondary">Touches</p>
        <p class="text-sm text-text-secondary">claim_work → release_work</p>
        <a href={`${base}docs/evidence#claim-policy_gates`} class="text-sm text-mint hover:text-text-primary transition-colors">
          Evidence &#8594;
        </a>
      </Panel>
      <Panel size="sm" class="space-y-phi-2">
        <h3 class="text-lg font-display text-text-primary">Evidence gate</h3>
        <p class="text-sm text-text-secondary">Evidence artifacts keep receipts complete.</p>
        <p class="text-sm text-text-secondary">Record evidence before release to keep the trail intact.</p>
        <p class="text-xs uppercase tracking-[0.25em] text-text-secondary">Touches</p>
        <p class="text-sm text-text-secondary">record_evidence → release_work</p>
        <a href={`${base}docs/evidence#claim-evidence_gate`} class="text-sm text-mint hover:text-text-primary transition-colors">
          Evidence &#8594;
        </a>
      </Panel>
      <Panel size="sm" class="space-y-phi-2">
        <h3 class="text-lg font-display text-text-primary">Completion gate</h3>
        <p class="text-sm text-text-secondary">Decisions + evidence complete the receipt.</p>
        <p class="text-sm text-text-secondary">Log the decision alongside the proof you attach.</p>
        <p class="text-xs uppercase tracking-[0.25em] text-text-secondary">Touches</p>
        <p class="text-sm text-text-secondary">record_decision → release_work</p>
        <a href={`${base}docs/evidence#claim-completion_gate`} class="text-sm text-mint hover:text-text-primary transition-colors">
          Evidence &#8594;
        </a>
      </Panel>
    </div>
  </Section>

  <Section tone="light" pad="tight" innerClass="max-w-4xl text-center">
    <SectionHeader
      title="Where gates live"
      subtitle="Gate criteria live in the implementation guide and map to the six-call loop."
      size="md"
      class="mb-phi-3"
    />
    <p class="text-sm text-text-secondary mb-phi-2">
      Enforcement status: building. Evidence and decisions are recorded today; strict blocking is coming.
    </p>
    <div class="flex flex-wrap justify-center gap-phi-2 text-sm">
      <a href={`${base}implementation#phase-gates`} class="text-mint hover:text-text-primary transition-colors">
        Implementation gates &#8594;
      </a>
      <a href={`${base}how-it-works#gates`} class="text-mint hover:text-text-primary transition-colors">
        Loop mapping &#8594;
      </a>
      <a href={`${base}docs/evidence`} class="text-mint hover:text-text-primary transition-colors">
        Evidence registry &#8594;
      </a>
    </div>
  </Section>
</Layout>
