---
import Layout from '../../layouts/Layout.astro';
import Section from '../../components/Section.astro';
import Panel from '../../components/Panel.astro';
import SectionHeader from '../../components/SectionHeader.astro';
import DocsWayfinding from '../../components/DocsWayfinding.astro';

const base = import.meta.env.BASE_URL.endsWith('/')
  ? import.meta.env.BASE_URL
  : `${import.meta.env.BASE_URL}/`;
---

<Layout title="Kernel Schema v0.1.3">
  <Section tone="dark" class="text-center" innerClass="max-w-3xl">
    <SectionHeader
      title="Kernel Schema v0.1.3"
      subtitle="The minimal, audited core that keeps execution stable."
      as="h1"
      size="xl"
    />
  </Section>

  <Section tone="light" pad="tight" class="border-t border-line/30" innerClass="max-w-4xl">
    <Panel size="sm">
      <p class="text-text-secondary mb-2">Status: APPROVED</p>
      <p class="text-text-secondary mb-2">Owner: DOCS_SPECS</p>
      <p class="text-text-secondary mb-2">Scope: Kernel schema + coordination.db</p>
      <p class="text-text-secondary mb-2">Version: 0.1.3</p>
      <p class="text-text-secondary">Date: 2025-12-29</p>
      <p class="text-text-secondary mt-phi-2">
        Canonical source:
        <a
          href="https://github.com/motus-os/motus/blob/main/packages/cli/docs/schema/index.md"
          class="text-mint hover:text-text-primary transition-colors"
          target="_blank"
          rel="noopener"
        >
          schema docs on GitHub
        </a>
      </p>
    </Panel>
  </Section>

  <Section tone="muted" pad="tight" innerClass="max-w-5xl">
    <SectionHeader title="Single Source of Truth" class="mb-phi-4" maxWidth="max-w-3xl">
      <span slot="subtitle">
        Kernel state lives in <span class="text-text-primary font-medium">~/.motus/coordination.db</span>.
        This file is the authoritative record for attempts, decisions, evidence, and leases.
      </span>
    </SectionHeader>
    <Panel size="sm">
      <code class="text-mint font-mono text-sm">~/.motus/coordination.db</code>
      <p class="text-text-secondary mt-2 text-sm">
        Kernel truth. Append-only governance. Deterministic replay.
      </p>
    </Panel>
  </Section>

  <Section tone="light" pad="tight" innerClass="max-w-5xl">
    <SectionHeader
      title="Schema reference"
      subtitle="Keep the site lightweight; the full schema lives in GitHub."
      class="mb-phi-4"
      maxWidth="max-w-2xl"
    />
    <Panel size="sm" class="space-y-phi-2">
      <p class="text-sm text-text-secondary">
        The schema details tables, invariants, and migrations for coordination.db.
      </p>
      <div class="flex flex-wrap gap-phi-2 text-sm">
        <a
          href="https://github.com/motus-os/motus/blob/main/packages/cli/docs/schema/index.md"
          class="text-mint hover:text-text-primary transition-colors"
          target="_blank"
          rel="noopener"
        >
          Open schema docs &#8594;
        </a>
        <a
          href={`${base}docs/evidence#claim-kernel_schema`}
          class="text-mint hover:text-text-primary transition-colors"
        >
          Evidence entry &#8594;
        </a>
      </div>
    </Panel>
  </Section>

  <Section tone="light" class="text-center" innerClass="max-w-4xl">
    <SectionHeader
      title="Full Schema Reference"
      subtitle="The proof registry links to the authoritative schema source."
      size="md"
      class="mb-8"
    />
    <a
      href={`${base}docs/evidence#claim-kernel_schema`}
      class="inline-flex items-center gap-2 bg-mint text-charcoal font-semibold px-phi-4 py-phi-2 rounded-lg hover:bg-white transition-colors"
    >
      View Schema Evidence
    </a>
  </Section>

  <Section tone="light" pad="tight" innerClass="max-w-5xl">
    <DocsWayfinding pageId="schema" base={base} />
  </Section>
</Layout>
